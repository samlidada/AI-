# 变更日志

## 2023-10-09

### 优化数据持久化配置

- **改进SwiftData持久化配置**
  - 修改了数据库初始化逻辑，确保数据持久存储而非仅内存存储
  - 简化了`ModelContainer`和`ModelConfiguration`的初始化方法
  - 移除了复杂的URL路径创建和不必要的错误处理嵌套
  - 更新了数据库文件存储位置为Documents目录
  - 增强了数据库创建状态的日志记录

- **解决非登录用户数据丢失问题**
  - 修复了非登录用户在应用重启后数据丢失的问题
  - 确保所有用户数据在应用重启后仍然保留
  - 优化了数据初始化流程，提供更可靠的数据存储机制

## 2023-10-07

### 优化目标详情页小目标管理逻辑

- **防止单一子任务被删除**
  - 修复了当目标只有一个子任务时可能导致的执行错误问题
  - 在子任务数量为1时，隐藏编辑模式按钮，防止用户进入编辑状态
  - 增加子任务删除按钮的显示条件判断，只有当目标拥有多个子任务时才允许删除
  - 在GoalViewModel中添加getGoalForSubTask方法，用于查找子任务对应的目标
  - 优化了用户体验，避免因删除唯一子任务导致的应用崩溃或逻辑错误

## 2023-10-06

### 修复目标详情页成果查看功能

- **修复已完成子任务成果查看问题**
  - 修复了目标详情页中已完成状态的子任务在评估或完成阶段无法查看成果的问题
  - 增强了子任务成果查看逻辑，不再仅限于执行阶段显示查看按钮
  - 任何状态下的已完成子任务现在都可以查看其上传的成果证明
  - 保持了应用的一致性体验，确保用户随时可以回顾完成的子任务成果

## 2023-10-05

### 个性化分享海报功能改进

- **改进连接线的展示**
  - 添加了对 ConnectingLine 组件的自定义属性支持
  - 实现虚线样式、线条宽度、内外距离等参数
  - 修复了浮点数取模运算的错误

- **优化布局**
  - 将固定高度改为最小高度和可滚动视图
  - 动态调整子任务分布的半径
  - 添加适当间距和填充，提升视觉效果

- **强化个性化元素**
  - 调整用户头像和名称至居中位置
  - 移除冗余界面元素
  - 简化设计，突出用户成就

- **改进内容展示**
  - 完整显示子任务名称而非截断
  - 扩大气泡尺寸，优化信息布局
  - 增加文本多行显示和居中对齐

- **精确的时间统计**
  - 优化时间显示文案
  - 从预计用时改为显示实际用时
  - 统一使用分钟作为时间单位
  - 修复总用时计算逻辑

- **多彩进度环**
  - 中央圆环根据子任务完成时间占比进行分段填充
  - 每段使用对应子任务的颜色
  - 直观展示每个子任务的时间贡献
